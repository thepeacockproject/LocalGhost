stages:
  - build

variables:
  msbuild: 'C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\MSBuild\Current\Bin\MSBuild.exe'

build_patcher:
    stage: build
    tags:
        - windows
    only:
        changes:
            - Patcher/**
    script:
        -  '& $msbuild .\Patcher\Hitman2Patcher.sln /t:Build /p:Configuration=Release'
        - Set-Variable -Name patcherversion -Value (Get-ChildItem .\Patcher\bin\x64\Release\Hitman2Patcher.exe | Select-Object -ExpandProperty VersionInfo).FileVersion
    artifacts:
        name: "Patcher-$patcherversion-$CI_COMMIT_REF_NAME"
        when: on_success
        expire_in: never
        paths:
            - Patcher/bin/x64/Release/Hitman2Patcher.exe